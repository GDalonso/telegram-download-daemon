version: '3.5'

# First startup instructions:
# 1. Copy .env.example to .env and fill in your credentials
# 2. docker-compose run --rm telegram-download-daemon-public
# 3. login with your phone number (e.g., +5511phonenumber)
# 4. After successful login, press Ctrl+C to stop
# 5. Then start normally with: docker-compose up -d

services:
  # Public channel service (active)
  telegram-download-daemon-public:
    build: .
    #image: alfem/telegram-download-daemon:latest
    container_name: telegram-download-public
    read_only: true
    env_file:
      - .env
    environment:
      TELEGRAM_DAEMON_API_ID: $TELEGRAM_DAEMON_API_ID
      TELEGRAM_DAEMON_API_HASH: $TELEGRAM_DAEMON_API_HASH
      TELEGRAM_DAEMON_CHANNEL: $TELEGRAM_DAEMON_CHANNEL_PUBLIC
      TELEGRAM_DAEMON_SESSION_PATH: "/newsession"
      TELEGRAM_DAEMON_DUPLICATES: ignore
      #TELEGRAM_DAEMON_WORKERS: 2
    volumes:
       - downloads_public:/downloads
       - sessions_public:/newsession
       - ${DOWNLOAD_PATH}:/telegram-downloads
    restart: unless-stopped

volumes:
    downloads:
    sessions:
    downloads_public:
    sessions_public:
